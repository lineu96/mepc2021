---
title: "Análises bivariadas"
output:
  html_document:                    
    #toc: true                       
    #toc_depth: 3                    
    #toc_float:                      
    #  collapsed: true
    #  smooth_scroll: true
    #number_sections: true           
    theme: flatly
    #spacelab
    #default,cerulean,journal,flatly,readable,spacelab,
    #united,cosmo,lumen,paper,sandstone,simplex,yeti
    
    highlight: espresso
    #default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, and textmate
    #css: styles.css                
    fig_width: 7                    
    fig_height: 6                   
    fig_caption: true               
    fig_align: 'center'
    #code_folding: hide              
#    keep_md: true                   
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = FALSE)
```

Análises bivariadas tem como objetivo buscar compreender como uma variável se comporta na presença de outra. Isto é, neste tipo de análise buscamos verificar se há relação entre duas variáveis.

---

### Entre duas variáveis qualitativas

---

#### Origem x Teste positivo {.tabset .tabset-fade .tabset-pills}

---

##### Tabela 1

<center>
```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE}

temp <- data.frame(origem = quest_21$origem,
                   covid = quest_21$covid_positivo)


table <- as.data.frame(table(temp))

pander(table)
```
</center>

---

##### Gráfico 1

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}

table$freq_r <- table$Freq/sum(table$Freq)
table$freq_r <- round(table$freq_r, 2)


ggplot(table, 
       aes(x=origem, y=Freq, fill=covid)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1, 
           position = 'dodge') +  
  ylim(c(0, 
         (max(table$Freq)+ (max(table$Freq)*0.05))))+
  geom_text(aes(label = Freq),
            #hjust=-0.1, 
            color=1, 
            size=8, 
            position=position_dodge(width=0.9),
            vjust=-0.5
  )+
  xlab("Origem") +
  ylab("Frequência") +
  ggtitle("Origem x Covid-19")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

##### Gráfico 2

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}
ggplot(table, 
       aes(x=origem, y=Freq, fill=covid)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1)+ 
  #  geom_text(aes(label = freq_r),
  #            hjust=0.5, 
  #            color=1, 
  #            size=8, 
  #            position=position_stack(), 
  #            vjust=1)+
  xlab("Origem") +
  ylab("Proporção") +
  ggtitle("Origem x Covid-19")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

##### Gráfico 3

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}
table2 <- as.matrix(prop.table(table(quest_21$covid_positivo,
                                     quest_21$origem), 
                               mar = 2))

table2 <- as.data.frame(table2)

names(table2) <- c('covid', 'origem', 'Freq')


ggplot(table2, 
       aes(x=origem, y=Freq, fill=covid)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1)+ 
  #  geom_text(aes(label = freq_r),
  #            hjust=0.5, 
  #            color=1, 
  #            size=8, 
  #            position=position_stack(), 
  #            vjust=1)+
  xlab("Origem") +
  ylab("Proporção") +
  ggtitle("Origem x Covid-19")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

#### Situação de emprego x Expectativa após PG {.tabset .tabset-fade .tabset-pills}

---

##### Tabela 1

<center>
```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE}

temp <- data.frame(emprego = quest_21$emprego,
                   expectativa = quest_21$expectativa_pos_pg)


table <- as.data.frame(table(temp))

pander(table)
```
</center>

---

##### Gráfico 1

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}

table$freq_r <- table$Freq/sum(table$Freq)
table$freq_r <- round(table$freq_r, 2)


ggplot(table, 
       aes(x=emprego, y=Freq, fill=expectativa)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1, 
           position = 'dodge') +  
  ylim(c(0, 
         (max(table$Freq)+ (max(table$Freq)*0.05))))+
  geom_text(aes(label = Freq),
            #hjust=-0.1, 
            color=1, 
            size=8, 
            position=position_dodge(width=0.9),
            vjust=-0.5
  )+
  xlab("Emprego") +
  ylab("Frequência") +
  ggtitle("Situação de emprego x Expectativa após PG")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

##### Gráfico 2

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}
ggplot(table, 
       aes(x=emprego, y=Freq, fill=expectativa)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1)+ 
  #  geom_text(aes(label = freq_r),
  #            hjust=0.5, 
  #            color=1, 
  #            size=8, 
  #            position=position_stack(), 
  #            vjust=1)+
  xlab("Emprego") +
  ylab("Proporção") +
  ggtitle("Situação de emprego x Expectativa após PG")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

##### Gráfico 3

```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE, warning=FALSE, fig.width=10}
table2 <- as.matrix(prop.table(table(quest_21$expectativa_pos_pg,
                                     quest_21$emprego), 
                               mar = 2))

table2 <- as.data.frame(table2)

names(table2) <- c('expectativa', 'emprego', 'Freq')


ggplot(table2, 
       aes(x=emprego, y=Freq, fill=expectativa)) + 
  geom_bar(stat = 'identity',
           col = 1,
           lwd = 1)+ 
  #  geom_text(aes(label = freq_r),
  #            hjust=0.5, 
  #            color=1, 
  #            size=8, 
  #            position=position_stack(), 
  #            vjust=1)+
  xlab("Emprego") +
  ylab("Proporção") +
  ggtitle("Situação de emprego x Expectativa após PG")+
  theme_classic() + theme(legend.position = 'top',
                          plot.title = element_text(family = "Helvetica", 
                                                    face = "bold", 
                                                    size = (20),
                                                    hjust = 0.5),
                          axis.title = element_text(face = "bold",
                                                    size = 15),
                          #axis.text = element_blank(),
                          #legend.title = element_blank(),
                          text = element_text(size=15)) 
```

---

<center>
<table><tr>
<td> <img src="img/prppg.png" alt="Drawing" style="width: 250px;"/> </td>
<td> <img src="img/LogoB.png" alt="Drawing" style="width: 50px;"/> </td>
<td> <img src="img/ufpr.jpg" alt="Drawing" style="width: 200px;"/> </td>
<td> <img src="img/LogoB.png" alt="Drawing" style="width: 50px;"/> </td>
<td> <img src="img/leg_logo.png" alt="Drawing" style="width: 300px;"/> </td>
</tr></table>
</center>

---

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>