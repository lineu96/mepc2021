size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
compara <- rbind(freq_n_ord(quest_21$transporte),
freq_n_ord(quest_20$ln_tipoTransp),
freq_n_ord(quest_19$ln_tipoTransp))
compara$Niveis <- c("Veículo Próprio",
"Transp. Público",
"A pé", "Bicicleta",
"Carona", "Táxi",
"Van/ônibus", "Outro")
### 2021
quest_21$transporte <- tolower(iconv(quest_21$transporte,
to ='ASCII//TRANSLIT',
from = "UTF-8"))
classOpcoes <- c("carro/moto proprio",
"transporte publico", "a pe", "bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus")
quest_21$transporte[ !quest_21$transporte %in% classOpcoes ] <- "outro"
quest_21$transporte <- factor(quest_21$transporte,
levels = c("carro/moto proprio",
"transporte publico", "a pe",
"bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus",
"outro"))
### 2020
quest_20$ln_tipoTransp <- tolower(iconv(quest_20$ln_tipoTransp,
to ='ASCII//TRANSLIT',
from = "UTF-8"))
classOpcoes <- c("carro/moto proprio",
"transporte publico", "a pe", "bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus")
quest_20$ln_tipoTransp[ !quest_20$ln_tipoTransp %in% classOpcoes ] <- "outro"
quest_20$ln_tipoTransp <- factor(quest_20$ln_tipoTransp,
levels = c("carro/moto proprio",
"transporte publico", "a pe",
"bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus",
"outro"))
### 2019
quest_19$ln_tipoTransp <- tolower(iconv(quest_19$ln_tipoTransp,
to ='ASCII//TRANSLIT',
from = "UTF-8"))
classOpcoes <- c("carro/moto proprio",
"transporte publico", "a pe", "bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus")
quest_19$ln_tipoTransp[ !quest_19$ln_tipoTransp %in% classOpcoes ] <- "outro"
quest_19$ln_tipoTransp <- factor(quest_19$ln_tipoTransp,
levels = c("carro/moto proprio",
"transporte publico", "a pe",
"bicicleta",
"carona com amigos", "taxi/aplicativo",
"servico fretado de van/onibus",
"outro"))
## Tabelas de frequencia
table1 <- freq_ord(quest_21$transporte)
compara <- rbind(freq_n_ord(quest_21$transporte),
freq_n_ord(quest_20$ln_tipoTransp),
freq_n_ord(quest_19$ln_tipoTransp))
compara$Niveis <- c("Veículo Próprio",
"Transp. Público",
"A pé", "Bicicleta",
"Carona", "Táxi",
"Van/ônibus", "Outro")
compara$Ano <- c(rep('2021',8), rep('2020',8), rep('2019',8))
compara$Frequencia.relativa <- round(compara$Frequencia.relativa,2)
ggplot(compara,
aes(x=reorder(Niveis, Frequencia.relativa),
y=Frequencia.relativa, fill=Ano)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(compara$Frequencia.relativa)+ (max(compara$Frequencia.relativa)*0.1))))+
coord_flip() +
geom_text(aes(label = Frequencia.relativa),
hjust=-0.1,
color=1,
size=5,
position=position_dodge(width=0.9),
vjust=0.5)+
ylab("Proporção") +
xlab("") +
ggtitle("Locomoção")+
theme_classic() + theme(#legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
compara <- rbind(freq_n_ord(quest_21$transporte),
freq_n_ord(quest_20$ln_tipoTransp),
freq_n_ord(quest_19$ln_tipoTransp))
compara$Niveis <- c("Veículo Próprio",
"Transp. Público",
"A pé", "Bicicleta",
"Carona", "Táxi",
"Van/ônibus", "Outro")
compara$Ano <- c(rep('2021',8), rep('2020',8), rep('2019',8))
compara$Frequencia.relativa <- round(compara$Frequencia.relativa,2)
ggplot(compara,
aes(x=reorder(Niveis, Frequencia.relativa),
y=Frequencia.relativa, fill=Ano)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(compara$Frequencia.relativa)+ (max(compara$Frequencia.relativa)*0.1))))+
coord_flip() +
geom_text(aes(label = Frequencia.relativa),
hjust=-0.1,
color=1,
size=5,
position=position_dodge(width=0.9),
vjust=0.5)+
ylab("Proporção") +
xlab("") +
ggtitle("Locomoção")+
theme_classic() + theme(#legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
idade_foto <- subset(quest_21, idade_foto >= 18 & idade_foto <= 60)
pander(tab_classes(idade_foto$idade_foto))
## 2021
quest_21$kiki_bouba <- tolower(iconv(quest_21$kiki_bouba,
to ='ASCII//TRANSLIT',
from = "UTF-8"))
quest_21$kiki_bouba <- factor(quest_21$kiki_bouba,
levels = tolower(c("A da esquerda se chama Bouba, a da direita se chama Kiki.",
"A da esquerda se chama Kiki, a da direita se chama Bouba.")))
## 2020
quest_20$ln_kiki <- tolower(iconv(quest_20$ln_kiki,
to ='ASCII//TRANSLIT',
from = "UTF-8"))
quest_20$ln_kiki <- factor(quest_20$ln_kiki,
levels = c("a se chama bouba e b se chama kiki.", "b se chama bouba e a se chama kiki."))
table1 <- freq_n_ord(quest_21$kiki_bouba)
table1 <- freq_n_ord(quest_21$kiki_bouba)
---
#### Tabela
<center>
```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE}
pander::pander(table1)
pander::pander(table1)
pander::pander(table1)
---
#### Gráfico
```{r, comment=FALSE, message=FALSE, fig.align='center', warning=TRUE, echo = FALSE}
table1$Niveis <- c('Bouba/Kiki', 'Kiki/Bouba')
ggplot(data=table1, aes(x=reorder(Niveis, -Frequencia),
y=Frequencia#,
#fill = Niveis
)) +
geom_bar(stat="identity",
col=1,
lwd=1)+
ylim(c(0,
(max(table1$Frequencia)+ (max(table1$Frequencia)*0.3))))+
geom_text(aes(label=Frequencia),
vjust=-1,
color=1,
size=8)+
ylab("Frequência") +
xlab("") +
ggtitle("Efeito Kiki Bouba")+
theme_classic() + theme(legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
#axis.text = element_blank(),
legend.title = element_blank(),
text = element_text(size=15))
compara <- rbind(freq_n_ord(quest_21$kiki_bouba),
freq_n_ord(quest_20$ln_kiki))
compara$Niveis <- c('Bouba/Kiki', 'Kiki/Bouba')
compara$Ano <- c(rep('2021',2), rep('2020',2))
compara$Frequencia.relativa <- round(compara$Frequencia.relativa,2)
ggplot(compara,
aes(x=reorder(Niveis, Frequencia.relativa),
y=Frequencia.relativa, fill=Ano)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(compara$Frequencia.relativa)+ (max(compara$Frequencia.relativa)*0.05))))+
coord_flip() +
geom_text(aes(label = Frequencia.relativa),
hjust=-0.1,
color=1,
size=5,
position=position_dodge(width=0.9),
vjust=0.5)+
ylab("Proporção") +
xlab("") +
ggtitle("Efeito Kiki Bouba")+
theme_classic() + theme(#legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
rmarkdown::render_site()
rmarkdown::render_site()
mestrado_21 <- subset(quest_21,
inicio_msc>1950 &
inicio_msc<2021 &
final_msc>1950 &
final_msc<2021 &
atividade_ies != "mestrado profissional" &
atividade_ies !="mestrado academico")
mestrado_21 <- subset(mestrado_21, inicio_msc < final_msc)
mestrado_21$tempo_mest <- mestrado_21$final_msc - mestrado_21$inicio_msc
mestrado_20 <- subset(quest_20,
tc_inicMest>1950 &
tc_inicMest<2020 &
tc_fimMest>1950 &
tc_fimMest<2020 &
lo_ativAtuacao != "mestrado profissional" &
lo_ativAtuacao !="mestrado academico")
mestrado_20 <- subset(mestrado_20, tc_inicMest < tc_fimMest)
mestrado_20$tempo_mest <- mestrado_20$tc_fimMest - mestrado_20$tc_inicMest
mestrado_19 <- subset(quest_19,
tc_inicMest>1950 &
tc_inicMest<2019 &
tc_fimMest>1950 &
tc_fimMest<2019 &
lo_ativAtuacao != "mestrado profissional" &
lo_ativAtuacao !="mestrado academico")
mestrado_19 <- subset(mestrado_19, tc_inicMest < tc_fimMest)
mestrado_19$tempo_mest <- mestrado_19$tc_fimMest - mestrado_19$tc_inicMest
compara <- rbind(freq_n_ord(mestrado_19$tempo_mest),
freq_n_ord(mestrado_20$tempo_mest),
freq_n_ord(mestrado_21$tempo_mest))
compara$Ano <- c(rep('2019',nrow(freq_n_ord(mestrado_19$tempo_mest))),
rep('2020',nrow(freq_n_ord(mestrado_20$tempo_mest))),
rep('2021',nrow(freq_n_ord(mestrado_21$tempo_mest))))
compara$Frequencia.relativa <- round(compara$Frequencia.relativa,2)
ggplot(compara,
aes(x=Niveis,
y=Frequencia.relativa, fill=Ano)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(compara$Frequencia.relativa)+ (max(compara$Frequencia.relativa)*0.05))))+
coord_flip() +
geom_text(aes(label = Frequencia.relativa),
hjust=-0.1,
color=1,
size=5,
position=position_dodge(width=0.9),
vjust=0.5)+
ylab("Proporção") +
xlab("") +
ggtitle("Tempo para conclusão do mestrado")+
theme_classic() + theme(#legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
irmaos_21 <- subset(quest_21,irmaos>=0 & irmaos<=10)
irmaos_20 <- subset(quest_20,td_numIrmao>=0 & td_numIrmao<=20)
irmaos_19 <- subset(quest_19,td_numIrmao>=0 & td_numIrmao<=20)
compara <- rbind(freq_n_ord(irmaos_19$td_numIrmao),
freq_n_ord(irmaos_20$td_numIrmao),
freq_n_ord(quest_21$irmaos))
compara$Ano <- c(rep('2019', nrow(freq_n_ord(irmaos_19$td_numIrmao))),
rep('2020', nrow(freq_n_ord(irmaos_20$td_numIrmao))),
rep('2021', nrow(freq_n_ord(irmaos_21$irmaos))))
irmaos_21 <- subset(quest_21,irmaos>=0 & irmaos<=10)
irmaos_20 <- subset(quest_20,td_numIrmao>=0 & td_numIrmao<=20)
irmaos_19 <- subset(quest_19,td_numIrmao>=0 & td_numIrmao<=20)
compara <- rbind(freq_n_ord(irmaos_19$td_numIrmao),
freq_n_ord(irmaos_20$td_numIrmao),
freq_n_ord(quest_21$irmaos))
nrow(compara)
c(rep('2019', nrow(freq_n_ord(irmaos_19$td_numIrmao))),
rep('2020', nrow(freq_n_ord(irmaos_20$td_numIrmao))),
rep('2021', nrow(freq_n_ord(irmaos_21$irmaos))))
compara
nrow(freq_n_ord(irmaos_19$td_numIrmao))
nrow(freq_n_ord(irmaos_20$td_numIrmao))
nrow(freq_n_ord(irmaos_21$irmaos))
compara <- rbind(freq_n_ord(irmaos_19$td_numIrmao),
freq_n_ord(irmaos_20$td_numIrmao),
freq_n_ord(quest_21$irmaos))
compara
freq_n_ord(irmaos_19$td_numIrmao)
freq_n_ord(irmaos_20$td_numIrmao)
freq_n_ord(quest_21$irmaos)
nrow(freq_n_ord(irmaos_19$td_numIrmao))
nrow(freq_n_ord(irmaos_20$td_numIrmao))
nrow(freq_n_ord(irmaos_21$irmaos))
freq_n_ord(irmaos_21$irmaos)
irmaos_21 <- subset(quest_21,irmaos>=0 & irmaos<=20)
irmaos_20 <- subset(quest_20,td_numIrmao>=0 & td_numIrmao<=20)
irmaos_19 <- subset(quest_19,td_numIrmao>=0 & td_numIrmao<=20)
compara <- rbind(freq_n_ord(irmaos_19$td_numIrmao),
freq_n_ord(irmaos_20$td_numIrmao),
freq_n_ord(irmaos_21$irmaos))
compara$Ano <- c(rep('2019', nrow(freq_n_ord(irmaos_19$td_numIrmao))),
rep('2020', nrow(freq_n_ord(irmaos_20$td_numIrmao))),
rep('2021', nrow(freq_n_ord(irmaos_21$irmaos))))
compara$Frequencia.relativa <- round(compara$Frequencia.relativa,2)
compara$Niveis <- as.numeric(as.vector(compara$Niveis))
ggplot(compara,
aes(x=reorder(Niveis, -Niveis),
y=Frequencia.relativa, fill=Ano)) +
geom_bar(stat = 'identity',
col = 1,
lwd = 1,
position = 'dodge') +
ylim(c(0,
(max(compara$Frequencia.relativa)+ (max(compara$Frequencia.relativa)*0.05))))+
coord_flip() +
geom_text(aes(label = Frequencia.relativa),
hjust=-0.1,
color=1,
size=5,
position=position_dodge(width=0.9),
vjust=0.5)+
ylab("Proporção") +
xlab("") +
ggtitle("Número de irmãos")+
theme_classic() + theme(#legend.position = 'none',
plot.title = element_text(family = "Helvetica",
face = "bold",
size = (20),
hjust = 0.5),
axis.title = element_text(face = "bold",
size = 15),
text = element_text(size=20))
rmarkdown::render_site()
library(tidyverse)
library(plyr)
library(pander)
library(ggpubr)
library(splitstackshape, quietly = TRUE)
library(lubridate)
library(GGally)
library(ggmosaic)
## TABELAS
#-----------------------------------------------------------------
### Tabela de frequencia simples não ordenada
freq_n_ord <- function(vetor){
fa <- table(vetor) # frequência absoluta
fr <- prop.table(fa) # frequência relativa
table <- data.frame(Niveis = names(fa),
Frequencia = as.vector(fa),
`Frequencia relativa` = as.vector(fr)) # unindo
table
}
#-----------------------------------------------------------------
### Tabela de frequencia simples ordenada
freq_ord <- function(vetor){
fa <- table(vetor) # frequência absoluta
fr <- prop.table(fa) # frequência relativa
table <- data.frame(Niveis = names(fa),
Frequencia = as.vector(fa),
`Frequencia relativa` = as.vector(fr)) # unindo
table <- arrange(table, desc(table$Frequencia))
table
}
#-----------------------------------------------------------------
### Tabela por classes
tab_classes <- function(vetor){
h <- hist(vetor, plot = FALSE) #histograma
breaks <- h$breaks #armazenando os breaks do histograma
classes <- cut(vetor, breaks = breaks,
include.lowest = TRUE, right = TRUE) #gerando classes
table <- as.data.frame(table(classes)) #gerando tabela com faixas
table$fr <- prop.table(table$Freq)
names(table) <- c('Classes', 'Frequencia', 'Frequencia relativa')
table
}
#-----------------------------------------------------------------
### Medidas de posição
posicao <- function(vetor){
table <- data.frame(Minimo = quantile(vetor)[1],
Quartil_1 = quantile(vetor)[2],
Media = mean(vetor),
Mediana = quantile(vetor)[3],
Quartil_3 = quantile(vetor)[4],
Maximo = quantile(vetor)[5])
row.names(table) <- NULL
table
}
#-----------------------------------------------------------------
### Medidas de dispersao
dispersao <- function(vetor){
table <- data.frame(Amplitude = diff(range(vetor)),
Variancia = var(vetor),
Desvio_padrao = sd(vetor),
Coef_variacao = 100*sd(vetor)/mean(vetor))
table
}
#-----------------------------------------------------------------
# Caminho
path <- "./Questionário-MEPC-2021 (respostas) - Respostas ao formulário 1.csv"
##################################################################
##################################################################
# Leitura e tratamento dos dados do questionário
##################################################################
# Caminho
#path <- "./teste.csv"
path <- "./Questionário-MEPC-2021 (respostas) - Respostas ao formulário 1.csv"
##################################################################
# Leitura dados 2021
quest_21 <- read.csv(path, sep = ',', encoding = 'UTF-8', header = T)
# Nome das colunas
names(quest_21) <-
c('data_hora', 'instituicao', 'setor_ufpr', 'atividade_ies',
'area_conhec', 'fim_grad', 'inst_grad', 'programas_grad', 'inicio_msc',
'final_msc', 'inst_msc', 'artigos', 'bolsa', 'materias_est',
'materias_n_est', 'software_sn', 'software_list', 'met_est',
'import_met_est', 'expectativa_pos_pg', 'conhec_trans', 'youtube',
'contat_coord', 'contat_colab', 'ensino_medio1', 'ensino_medio2',
'sexo', 'altura', 'peso', 'nascimento', 'emprego', 'residencia',
'irmaos', 'origem', 'cnh', 'transporte', 'tempo_ies', 'app_transporte',
'pet', 'instrumento', 'redes_sociais', 'atv_fisica_reg', 'atv_fisica_n',
'atv_fisica_qual', 'covid_positivo', 'covid_conhecido',
'covid_gr_risco_me', 'covid_gr_risco_outro', 'covid_vacina',
'medidas_eficazes', 'medidas_seguidas', 'covid_renda', 'covid_estudos',
'covid_aprendizado', 'covid_ere', 'dificuldade_ere', 'covid_conclusao', 'descartada',
'idade_foto', 'kiki_bouba', 'quadrados')
quest_21 <- quest_21[4:nrow(quest_21),]
##################################################################
# Leitura dados 2020
path <- "./resp_mpec2020 - Respostas ao formulário 1.csv"
quest_20 <- read.csv(path, sep = ',', encoding = 'UTF-8')
#quest <- read.csv(path, sep = ',', encoding = 'latin1')
# Excluindo a primeira coluna referente aos carimbos de data e hora do google forms
quest_20 <- quest_20[,-1]
# Classificacao das variaves
# lo/ln - var qualitativa ordinal, nominal
# td - var quantitativa discreta
# Renomeando as colunas
names(quest_20) <-
c(
# questoes academicas
"ln_instituicao", "ln_setorAtuacao", "lo_ativAtuacao",
"ln_setorArea", "tc_anoFimGrad", "ln_localGrad",
"ln_progGrad", "tc_inicMest", "tc_fimMest",
"ln_localMest", "td_artigo", "ln_bolsaEstudo",
"td_estatGrad", "td_estatPGrad", "lo_soft",
"ln_enumSoft", "lo_importancia", "td_notaImport",
"ln_expectAposPG", "ln_conhecTransv", "lo_videoTransv",
"ln_turma", "lo_contatoProfDisc", "lo_contatoProfColabDisc",
"ln_medio1", "ln_medio2",
# perfil do aluno
"ln_sexo", "tc_altura", "tc_peso",
"dataNasc", "ln_tipoTrab", "ln_compMoradia",
"td_numIrmao", "ln_origem", "ln_tipoHab",
"ln_tipoTransp", "tc_tempoPUniv", "td_qtddServTransp",
"ln_pet", "ln_instr","ln_rede",
#questoes extra
"tc_idadeProf", "ln_kiki"
)
##################################################################
# Leitura dados 2019
path <- "./resp_2019.csv"
quest_19 <- read.csv(path, sep = ',', encoding = 'UTF-8')
quest_19 <- data.frame(quest_19[,-1], stringsAsFactors = FALSE)
names(quest_19) <- c("lo_ativAtuacao", "ln_setorAtuacao",
"tc_anoFimGrad", "ln_localGrad",
"ln_progGrad", "tc_inicMest", "tc_fimMest",
"ln_localMest", "td_artigo", "ln_bolsaEstudo",
"td_estatGrad", "td_estatPGrad", "lo_soft",
"ln_enumSoft", "lo_importancia", "td_notaImport",
"ln_tipoTrab", "ln_sexo", "td_numIrmao",
"ln_origem", "ln_compMoradia", "ln_tipoTransp",
"ln_tipoHab", "tc_tempoPUniv", "tc_altura",
"tc_peso", "ln_pet", "ln_instr", "dataNasc",
"ln_rede", "td_qtddServTransp", "lo_provNetflix",
"ln_arrozNatal", "tc_idadeProf", "ln_expectAposPG",
"ln_conhecTransv", "lo_videoTransv",
"lo_contatoProfDisc", "lo_contatoProfColabDisc")
##################################################################
rmarkdown::render_site()
idade_foto$indica_foto <- c(rep('Foto 1', 50),
rep('Foto 2', 5)#,
#rep('Foto 1', 179),
#rep('Foto 2', 170)
)
rmarkdown::render_site()
rmarkdown::render_site()
